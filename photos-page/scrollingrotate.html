<!DOCTYPE html>
<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>

<style>

body {
    background: #ffc;
    height: 2000px;
    margin: 0;	
    padding: 0px;
}

#cog {
    background: url('http://khasachi.com/photos-page/photos/05.25.13.jpg');
    background-size: cover;
    border-radius: 10px;
    width: 800px;
    height: 602px;
    margin-top: 130px;
    margin-left: auto;
    margin-right: auto;
    transform: rotate(10deg);
    transform-origin: top left;
    transition: all 1s;    

}

#cog2 {
    background: url('http://khasachi.com/photos-page/photos/06.17.13.JPG');
    background-size: cover;
    border-radius: 10px;
    width: 800px;
    height: 602px;
    margin-top: 130px;
    margin-left: auto;
    margin-right: auto;
    transform: rotate(-10deg);
    transition-origin: top right;
    transition: all 1s;}

#cog3 {
    background: url('http://khasachi.com/photos-page/photos/07.25.13.JPG');
    background-size: cover;
    border-radius: 10px;
    width: 800px;
    height: 602px;
    margin-top: 130px;
    margin-left: auto;
    margin-right: auto;
    transform: rotate(10deg);
    transition-origin: top left;
    transition: all 1s;
/*    transition-duration: 0.5s;
    transition-timing-function: step-end; */
}

</style>




</head>

<body>
    <div id="cog" >
        
    </div>
    <div id="cog2"></div>

    <div id="cog3"></div>

<script>
var angle = 3;
var $cog = $('#cog');
var $cog2 = $('#cog2');
var $cog3 = $('#cog3');

var scrollTop =$(window).scrollTop();

var cog1Offset = $("#cog").offset().top;
var cog2Offset = $("#cog2").offset().top;
var cog3Offset = $("#cog3").offset().top;

var distanceOneInit = ((cog1Offset - scrollTop)/$(window).height()) * 100;
var distanceTwoInit = ((cog2Offset - scrollTop)/$(window).height()) * 100;
var distanceThreeInit = ((cog3Offset - scrollTop)/$(window).height()) * 100;

$(window).scroll(function () {
	var scrollTop =$(window).scrollTop();

	var cog1MovingOffset = $("#cog").offset().top;
	var cog2MovingOffset = $("#cog2").offset().top;
	var cog3MovingOffset = $("#cog3").offset().top;

        var distanceOneMove = ((cog1MovingOffset - scrollTop)/$(window).height()) * 100;
	var distanceTwoMove = ((cog2MovingOffset - scrollTop)/$(window).height()) * 100;
	var distanceThreeMove = ((cog3MovingOffset - scrollTop)/$(window).height()) * 100;
	        
	console.log(distanceOneInit);
	console.log(distanceOneMove);
    
    if (distanceOneMove < distanceOneInit+1)
    {
         $cog.css({
                'transform': 'rotate('  + 0 +  'deg)'
            });
        $cog.css({
                'transform-origin': 'top left'
            });
    }

        if (distanceOneMove >= distanceOneInit-5)
    {
         $cog.css({
                'transform': 'rotate('  + 10 +  'deg)'
            });
            
        $cog.css({
                'transform-origin': 'top left'
            });
        
    }

    if (distanceTwoMove < distanceTwoInit+1)
    {
         $cog2.css({
                'transform': 'rotate('  + 0 +  'deg)'
            });
        $cog2.css({
                'transform-origin': 'top right'
            });
    }

        if (distanceTwoMove >= distanceTwoInit-5)
    {
         $cog2.css({
                'transform': 'rotate('  + -10 +  'deg)'
            });
            
        $cog2.css({
                'transform-origin': 'top right'
            });
        
    }

    if (distanceThreeMove < distanceThreeInit+1)
    {
         $cog3.css({
                'transform': 'rotate('  + 0 +  'deg)'
            });
        $cog3.css({
                'transform-origin': 'top left'
            });
    }

        if (distanceThreeMove >= distanceThreeInit-5)
    {
         $cog3.css({
                'transform': 'rotate('  + 10 +  'deg)'
            });
            
        $cog3.css({
                'transform-origin': 'top left'
            });
        
    }



    
    });


/*
function getRotationDegrees(obj) {
    var matrix = obj.css("-webkit-transform") ||
    obj.css("-moz-transform")    ||
    obj.css("-ms-transform")     ||
    obj.css("-o-transform")      ||
    obj.css("transform");
    if(matrix !== 'none') {
        var values = matrix.split('(')[1].split(')')[0].split(',');
        var a = values[0];
        var b = values[1];
        var angle = Math.round(Math.atan2(b, a) * (180/Math.PI));
    } else { var angle = 0; }
    return (angle < 0) ? angle + 360 : angle;
}




var $cog = $('#cog'),
    $cog2 = $('#cog2'),
    $body = $(document.body),
    $cogZero = ($body.scrollTop());
    bodyHeight = $body.height();


$(window).scroll(function () {
    angle1 = getRotationDegrees($('#cog'));
    angle2 = getRotationDegrees($('#cog2'));
    $cogZero = ($body.scrollTop());
    if ($cogZero <= $body.height())
    {

        if (((angle1>=0) && (angle1 <= 10))  || ((angle2>=-5) && (angle2 <= 0))) 
        {
            $cog.css({
                'transform': 'rotate('  + $cogZero/40 +  'deg)'
            });
            $cog2.css({
                'transform': 'rotate('   + (-$cogZero/50) +  'deg)'
            });
        }
        if ((angle1>=1) || (angle2 >=1))
        {
            $cog.css({
                'transform': 'rotate(' + $cogZero/40   + 'deg)'
            });
            $cog2.css({
                'transform': 'rotate(' +  -$cogZero/50   + 'deg)'
            });
        }



    }
                     

    
    
    console.log($cogZero);

    $cog.text( "scrollTop:" + $body.scrollTop() ); 
    $cog2.text( "scrollTop:" + $cog.scrollTop() );

    
});*/


</script>
</body>



</html>
